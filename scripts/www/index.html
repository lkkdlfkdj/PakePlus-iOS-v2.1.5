<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>è€ƒå‹¤ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="styles-light.css">
</head>
<body>
    <div class="container">
        <header class="app-header">
            <h1>è€ƒå‹¤ç®¡ç†</h1>
        </header>
        
        <nav class="tab-nav">
            <button class="tab-button active" onclick="showTab('overtime', this)">
                <span class="tab-icon">â°</span>
                <span class="tab-text">åŠ ç­</span>
            </button>
            <button class="tab-button" onclick="showTab('compensatory', this)">
                <span class="tab-icon">ğŸ”„</span>
                <span class="tab-text">è¡¥ä¼‘</span>
            </button>
            <button class="tab-button" onclick="showTab('leave', this)">
                <span class="tab-icon">ğŸƒ</span>
                <span class="tab-text">è¯·å‡</span>
            </button>
            <button class="tab-button" onclick="showTab('history', this)">
                <span class="tab-icon">ğŸ“Š</span>
                <span class="tab-text">å†å²</span>
            </button>
            <button class="tab-button" onclick="showTab('export', this)">
                <span class="tab-icon">ğŸ“¤</span>
                <span class="tab-text">å¯¼å‡º</span>
            </button>
        </nav>

        <main class="main-content">
            <!-- åŠ ç­æ ‡ç­¾é¡µ -->
            <div id="overtime" class="tab-content active">
                <div class="card">
                    <form id="overtimeForm" class="mobile-form">
                        <div class="form-group">
                            <label for="overtimeDate">åŠ ç­æ—¥æœŸ</label>
                            <input type="date" id="overtimeDate" required>
                        </div>
                        <div class="form-group">
                            <label for="overtimeTimeSlot">æ—¶é—´æ®µ</label>
                            <select id="overtimeTimeSlot" required>
                                <option value="">è¯·é€‰æ‹©æ—¶é—´æ®µ</option>
                                <option value="morning">ä¸Šåˆ8:00-12:00</option>
                                <option value="afternoon">ä¸‹åˆ14:00-18:00</option>
                                <option value="evening">æ™šä¸Š19:00-23:00</option>
                                <option value="custom">è‡ªå®šä¹‰</option>
                            </select>
                            <div class="time-slot-info" id="timeSlotInfo" style="display: none;">
                                <small class="info-text"></small>
                            </div>
                        </div>
                        <div class="form-group" id="customOvertimeTimeSlot" style="display: none;">
                            <label for="customOvertimeTimeText">è‡ªå®šä¹‰æ—¶é—´æ®µ</label>
                            <input type="text" id="customOvertimeTimeText" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰æ—¶é—´æ®µï¼Œå¦‚ï¼š09:00-17:00">
                        </div>
                        
                        <!-- ç…§ç‰‡ä¸Šä¼ åŒºåŸŸ -->
                        <div class="form-group" id="photoUploadSection" style="display: none;">
                            <label>åŠ ç­ç…§ç‰‡ <span class="required-photos" id="requiredPhotos"></span></label>
                            <div class="photo-upload-container">
                                <div class="photo-upload-area" id="photoUpload1">
                                    <input type="file" id="photoFile1" accept="image/*" capture="environment" style="display: none;">
                                    <div class="upload-placeholder" onclick="triggerPhotoUpload(1)">
                                        <span class="upload-icon">ğŸ“·</span>
                                        <span class="upload-text">ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡1</span>
                                    </div>
                                    <div class="photo-preview" id="photoPreview1" style="display: none;">
                                        <img id="photoImg1" src="" alt="ç…§ç‰‡é¢„è§ˆ">
                                        <button type="button" class="remove-photo" onclick="removePhoto(1)">Ã—</button>
                                    </div>
                                </div>
                                
                                <div class="photo-upload-area" id="photoUpload2" style="display: none;">
                                    <input type="file" id="photoFile2" accept="image/*" capture="environment" style="display: none;">
                                    <div class="upload-placeholder" onclick="triggerPhotoUpload(2)">
                                        <span class="upload-icon">ğŸ“·</span>
                                        <span class="upload-text">ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡2</span>
                                    </div>
                                    <div class="photo-preview" id="photoPreview2" style="display: none;">
                                        <img id="photoImg2" src="" alt="ç…§ç‰‡é¢„è§ˆ">
                                        <button type="button" class="remove-photo" onclick="removePhoto(2)">Ã—</button>
                                    </div>
                                </div>
                            </div>
                            <div class="photo-upload-tips">
                                <small>ğŸ’¡ å»ºè®®æ‹æ‘„å·¥ä½œç°åœºæˆ–ç›¸å…³è¯æ˜ç…§ç‰‡</small>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="overtimeReason">åŠ ç­åŸå› </label>
                            <select id="overtimeReason" required>
                                <option value="">è¯·é€‰æ‹©åŠ ç­åŸå› </option>
                                <option value="saturday">å‘¨å…­åŠ ç­</option>
                                <option value="weekend">å‘¨æœ«åŠ ç­</option>
                                <option value="city">åˆ›åŸåŠ ç­</option>
                                <option value="custom">è‡ªå®šä¹‰</option>
                            </select>
                        </div>
                        <div class="form-group" id="customOvertimeReason" style="display: none;">
                            <label for="customOvertimeText">è‡ªå®šä¹‰åŸå› </label>
                            <input type="text" id="customOvertimeText" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰åŸå› ">
                        </div>
                        
                        <!-- æäº¤çŠ¶æ€æç¤º -->
                        <div class="form-validation" id="formValidation" style="display: none;">
                            <div class="validation-item" id="dateValidation">
                                <span class="validation-icon">â°</span>
                                <span class="validation-text">æ—¶é—´æ®µå”¯ä¸€æ€§æ£€æŸ¥</span>
                                <span class="validation-status" id="dateStatus">å¾…æ£€æŸ¥</span>
                            </div>
                            <div class="validation-item" id="photoValidation">
                                <span class="validation-icon">ğŸ“·</span>
                                <span class="validation-text">ç…§ç‰‡ä¸Šä¼ è¦æ±‚</span>
                                <span class="validation-status" id="photoStatus">å¾…ä¸Šä¼ </span>
                            </div>
                        </div>
                        
                        <button type="submit" class="submit-btn" id="submitBtn">æäº¤åŠ ç­ç”³è¯·</button>
                    </form>
                </div>
            </div>

            <!-- è¡¥ä¼‘æ ‡ç­¾é¡µ -->
            <div id="compensatory" class="tab-content">
                <div class="card">
                    <form id="compensatoryForm" class="mobile-form">
                        <div class="form-group">
                            <label for="compensatoryDate">è¡¥ä¼‘æ—¥æœŸ</label>
                            <input type="date" id="compensatoryDate" required>
                        </div>
                        <div class="form-group">
                            <label for="attendanceTeam">è€ƒå‹¤é˜Ÿä¼</label>
                            <div class="input-with-lock">
                                <select id="attendanceTeam" required>
                                    <option value="">è¯·é€‰æ‹©è€ƒå‹¤é˜Ÿä¼</option>
                                    <option value="law1">æ‰§æ³•ä¸€ä¸­é˜Ÿ</option>
                                    <option value="law2">æ‰§æ³•äºŒä¸­é˜Ÿ</option>
                                    <option value="law3">æ‰§æ³•ä¸‰ä¸­é˜Ÿ</option>
                                    <option value="law4">æ‰§æ³•å››ä¸­é˜Ÿ</option>
                                </select>
                                <button type="button" id="teamModifyBtn" onclick="toggleTeamLock()" class="lock-btn">ğŸ”“</button>
                                <button type="button" id="teamFixBtn" onclick="toggleTeamLock()" class="lock-btn fixed" style="display: none;">ğŸ”’</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="attendanceGroup">è€ƒå‹¤ç»„</label>
                            <div class="input-with-lock">
                                <select id="attendanceGroup" required>
                                    <option value="">è¯·é€‰æ‹©è€ƒå‹¤ç»„</option>
                                    <option value="jiaonan1">è•‰å—ä¸€ç»„</option>
                                    <option value="jiaonan2">è•‰å—äºŒç»„</option>
                                    <option value="jiaonan3">è•‰å—ä¸‰ç»„</option>
                                    <option value="jiaonan4">è•‰å—å››ç»„</option>
                                </select>
                                <button type="button" id="groupModifyBtn" onclick="toggleGroupLock()" class="lock-btn">ğŸ”“</button>
                                <button type="button" id="groupFixBtn" onclick="toggleGroupLock()" class="lock-btn fixed" style="display: none;">ğŸ”’</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="shiftSchedule">ç­æ¬¡</label>
                            <div class="input-with-lock">
                                <select id="shiftSchedule" required>
                                    <option value="">è¯·é€‰æ‹©ç­æ¬¡</option>
                                    <option value="A14">A14</option>
                                    <option value="A16">A16</option>
                                    <option value="A17">A17</option>
                                    <option value="A18">A18</option>
                                    <option value="A19">A19</option>
                                    <option value="A2">A2</option>
                                    <option value="A20">A20</option>
                                    <option value="A21">A21</option>
                                    <option value="A22">A22</option>
                                    <option value="A23">A23</option>
                                    <option value="A27">A27</option>
                                    <option value="A30">A30</option>
                                    <option value="A31">A31</option>
                                    <option value="A32">A32</option>
                                    <option value="A35">A35</option>
                                    <option value="A37">A37</option>
                                    <option value="A39">A39</option>
                                    <option value="A40">A40</option>
                                    <option value="A46">A46</option>
                                    <option value="A47">A47</option>
                                    <option value="A48">A48</option>
                                    <option value="A49">A49</option>
                                    <option value="A50">A50</option>
                                    <option value="A51">A51</option>
                                    <option value="A52">A52</option>
                                    <option value="A53">A53</option>
                                    <option value="A54">A54</option>
                                    <option value="A55">A55</option>
                                    <option value="A56">A56</option>
                                    <option value="A57">A57</option>
                                    <option value="A58">A58</option>
                                    <option value="A59">A59</option>
                                    <option value="A65">A65</option>
                                    <option value="A66">A66</option>
                                    <option value="A69">A69</option>
                                    <option value="A7">A7</option>
                                    <option value="A71">A71</option>
                                    <option value="A74">A74</option>
                                    <option value="A8">A8</option>
                                </select>
                                <button type="button" id="shiftModifyBtn" onclick="toggleShiftLock()" class="lock-btn">ğŸ”“</button>
                                <button type="button" id="shiftFixBtn" onclick="toggleShiftLock()" class="lock-btn fixed" style="display: none;">ğŸ”’</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="compensatoryTimeSlot">æ—¶é—´æ®µ</label>
                            <div id="shiftTimeDisplay" class="shift-time-display" style="display: none;">
                                <div class="time-info">è¯·å…ˆé€‰æ‹©ç­æ¬¡</div>
                            </div>
                            <select id="compensatoryTimeSlot" required>
                                <option value="">è¯·é€‰æ‹©æ—¶é—´æ®µ</option>
                                <option value="morning">ä¸Šåˆ7:00-11:00</option>
                                <option value="afternoon">ä¸‹åˆ14:30-17:30</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>é”å®šæ§åˆ¶</label>
                            <div class="lock-control-buttons">
                                <button type="button" onclick="unlockAll()" class="unlock-all-btn">å–æ¶ˆæ‰€æœ‰é”å®š</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="relatedOvertime">å…³è”åŠ ç­è®°å½•</label>
                            <select id="relatedOvertime" required>
                                <option value="">è¯·é€‰æ‹©å…³è”çš„åŠ ç­è®°å½•</option>
                            </select>
                        </div>
                        <button type="submit" class="submit-btn">æäº¤è¡¥ä¼‘ç”³è¯·</button>
                    </form>
                </div>
            </div>

            <!-- è¯·å‡æ ‡ç­¾é¡µ -->
            <div id="leave" class="tab-content">
                <div class="card">
                    <form id="leaveForm" class="mobile-form">
                        <div class="form-group">
                            <label for="leaveDate">è¯·å‡æ—¥æœŸ</label>
                            <input type="date" id="leaveDate" required>
                        </div>
                        <div class="form-group">
                            <label for="leaveTimeSlot">æ—¶é—´æ®µ</label>
                            <select id="leaveTimeSlot" required>
                                <option value="">è¯·é€‰æ‹©æ—¶é—´æ®µ</option>
                                <option value="morning">ä¸Šåˆ7:00-11:00</option>
                                <option value="afternoon">ä¸‹åˆ14:30-17:30</option>
                                <option value="custom">è‡ªå®šä¹‰</option>
                            </select>
                        </div>
                        <div class="form-group" id="customLeaveTimeSlot" style="display: none;">
                            <label for="customLeaveTimeText">è‡ªå®šä¹‰æ—¶é—´æ®µ</label>
                            <input type="text" id="customLeaveTimeText" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰æ—¶é—´æ®µï¼Œå¦‚ï¼š09:00-15:00">
                        </div>
                        <div class="form-group">
                            <label for="leaveReason">è¯·å‡åŸå› </label>
                            <select id="leaveReason" required>
                                <option value="">è¯·é€‰æ‹©è¯·å‡åŸå› </option>
                                <option value="personal">äº‹å‡</option>
                                <option value="sick">ç—…å‡</option>
                                <option value="custom">è‡ªå®šä¹‰</option>
                            </select>
                        </div>
                        <div class="form-group" id="customLeaveReason" style="display: none;">
                            <label for="customLeaveText">è‡ªå®šä¹‰åŸå› </label>
                            <input type="text" id="customLeaveText" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰åŸå› ">
                        </div>
                        <button type="submit" class="submit-btn">æäº¤è¯·å‡ç”³è¯·</button>
                    </form>
                </div>
            </div>

            <!-- å†å²è§†å›¾æ ‡ç­¾é¡µ -->
            <div id="history" class="tab-content">
                <div class="card">
                    <div class="statistics-mobile">
                        <div class="stat-card">
                            <div class="stat-number" id="totalOvertime">0</div>
                            <div class="stat-label">åŠ ç­æ€»æ¬¡æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalCompensatory">0</div>
                            <div class="stat-label">è¡¥ä¼‘æ€»æ¬¡æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="remainingCount">0</div>
                            <div class="stat-label">å‰©ä½™æ¬¡æ•°</div>
                        </div>
                    </div>
                    
                    <div id="expirationWarning" class="warning-mobile" style="display: none;"></div>
                    
                    <!-- ä¸‡å¹´å† -->
                    <div class="calendar-mobile">
                        <div class="calendar-header-mobile">
                            <button id="prevMonth" class="calendar-nav-mobile">â€¹</button>
                            <span id="currentMonth" class="calendar-title-mobile"></span>
                            <button id="nextMonth" class="calendar-nav-mobile">â€º</button>
                        </div>
                        <div class="calendar-legend-mobile">
                            <span class="legend-item-mobile"><span class="legend-dot overtime-color"></span>åŠ ç­</span>
                            <span class="legend-item-mobile"><span class="legend-dot compensatory-color"></span>è¡¥ä¼‘</span>
                            <span class="legend-item-mobile"><span class="legend-dot leave-color"></span>è¯·å‡</span>
                            <span class="legend-item-mobile"><span class="legend-dot full-compensatory-color"></span>å…¨è¡¥</span>
                        </div>
                        <div id="calendar" class="calendar-grid-mobile"></div>
                    </div>
                    
                    <div class="history-list-mobile" id="historyList"></div>
                </div>
            </div>

            <!-- å¯¼å‡ºæ ‡ç­¾é¡µ -->
            <div id="export" class="tab-content">
                <div class="card">
                    <div class="export-section">
                        <h3>ç­›é€‰æ¡ä»¶</h3>
                        <div class="export-filters-mobile">
                            <div class="form-group">
                                <label for="exportYear">å¹´ä»½</label>
                                <select id="exportYear">
                                    <option value="">å…¨éƒ¨å¹´ä»½</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="exportMonth">æœˆä»½</label>
                                <select id="exportMonth">
                                    <option value="">å…¨éƒ¨æœˆä»½</option>
                                    <option value="01">1æœˆ</option>
                                    <option value="02">2æœˆ</option>
                                    <option value="03">3æœˆ</option>
                                    <option value="04">4æœˆ</option>
                                    <option value="05">5æœˆ</option>
                                    <option value="06">6æœˆ</option>
                                    <option value="07">7æœˆ</option>
                                    <option value="08">8æœˆ</option>
                                    <option value="09">9æœˆ</option>
                                    <option value="10">10æœˆ</option>
                                    <option value="11">11æœˆ</option>
                                    <option value="12">12æœˆ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="exportType">å¯¼å‡ºç±»å‹</label>
                                <select id="exportType" onchange="updateFieldOptions()">
                                    <option value="overtime">åŠ ç­è®°å½•</option>
                                    <option value="compensatory">è¡¥ä¼‘è®°å½•</option>
                                    <option value="leave">è¯·å‡è®°å½•</option>
                                    <option value="all">å…¨éƒ¨è®°å½•</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å­—æ®µé€‰æ‹©åŒºåŸŸ -->
                    <div class="field-selection-mobile">
                        <h3>é€‰æ‹©å­—æ®µ</h3>
                        <div class="field-templates-mobile">
                            <button type="button" onclick="selectAllFields()" class="template-btn-mobile">å…¨é€‰</button>
                            <button type="button" onclick="clearAllFields()" class="template-btn-mobile">æ¸…ç©º</button>
                            <button type="button" onclick="loadTemplate('basic')" class="template-btn-mobile">åŸºç¡€</button>
                            <button type="button" onclick="loadTemplate('detailed')" class="template-btn-mobile">è¯¦ç»†</button>
                        </div>
                        
                        <!-- å­—æ®µé€‰æ‹©ç»„ -->
                        <div id="overtimeFields" class="field-group-mobile">
                            <div class="field-checkboxes-mobile">
                                <label class="checkbox-mobile"><input type="checkbox" value="åŠ ç­æ—¥æœŸ" checked><span>åŠ ç­æ—¥æœŸ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="æ—¶é—´æ®µ" checked><span>æ—¶é—´æ®µ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="åŠ ç­åŸå› " checked><span>åŠ ç­åŸå› </span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="çŠ¶æ€" checked><span>çŠ¶æ€</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="ç…§ç‰‡æ•°é‡"><span>ç…§ç‰‡æ•°é‡</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="ç…§ç‰‡ä¿¡æ¯"><span>ç…§ç‰‡ä¿¡æ¯</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="åˆ›å»ºæ—¶é—´"><span>åˆ›å»ºæ—¶é—´</span></label>
                            </div>
                        </div>
                        
                        <div id="compensatoryFields" class="field-group-mobile" style="display: none;">
                            <div class="field-checkboxes-mobile">
                                <label class="checkbox-mobile"><input type="checkbox" value="è¡¥ä¼‘æ—¥æœŸ" checked><span>è¡¥ä¼‘æ—¥æœŸ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="è€ƒå‹¤é˜Ÿä¼" checked><span>è€ƒå‹¤é˜Ÿä¼</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="è€ƒå‹¤ç»„" checked><span>è€ƒå‹¤ç»„</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="ç­æ¬¡" checked><span>ç­æ¬¡</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="ç­æ¬¡æ—¶é—´"><span>ç­æ¬¡æ—¶é—´</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="æ—¶é—´æ®µ" checked><span>æ—¶é—´æ®µ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="å…³è”åŠ ç­æ—¥æœŸ" checked><span>å…³è”åŠ ç­æ—¥æœŸ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="å…³è”åŠ ç­æ—¶é—´æ®µ" checked><span>å…³è”åŠ ç­æ—¶é—´æ®µ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="åŠ ç­åŸå› " checked><span>åŠ ç­åŸå› </span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="åˆ›å»ºæ—¶é—´"><span>åˆ›å»ºæ—¶é—´</span></label>
                            </div>
                        </div>
                        
                        <div id="leaveFields" class="field-group-mobile" style="display: none;">
                            <div class="field-checkboxes-mobile">
                                <label class="checkbox-mobile"><input type="checkbox" value="è¯·å‡æ—¥æœŸ" checked><span>è¯·å‡æ—¥æœŸ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="æ—¶é—´æ®µ" checked><span>æ—¶é—´æ®µ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="è¯·å‡åŸå› " checked><span>è¯·å‡åŸå› </span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="åˆ›å»ºæ—¶é—´"><span>åˆ›å»ºæ—¶é—´</span></label>
                            </div>
                        </div>
                        
                        <div id="allFields" class="field-group-mobile" style="display: none;">
                            <div class="field-checkboxes-mobile">
                                <label class="checkbox-mobile"><input type="checkbox" value="ç±»å‹" checked><span>ç±»å‹</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="æ—¥æœŸ" checked><span>æ—¥æœŸ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="æ—¶é—´æ®µ" checked><span>æ—¶é—´æ®µ</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="è¯¦ç»†ä¿¡æ¯" checked><span>è¯¦ç»†ä¿¡æ¯</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="é˜Ÿä¼/ç»„"><span>é˜Ÿä¼/ç»„</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="ç­æ¬¡"><span>ç­æ¬¡</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="ç…§ç‰‡ä¿¡æ¯"><span>ç…§ç‰‡ä¿¡æ¯</span></label>
                                <label class="checkbox-mobile"><input type="checkbox" value="åˆ›å»ºæ—¶é—´"><span>åˆ›å»ºæ—¶é—´</span></label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="export-actions-mobile">
                        <button onclick="showExportPreview()" class="preview-btn-mobile">æ˜¾ç¤ºç»“æœ</button>
                        <button onclick="exportFilteredData()" class="export-btn-mobile">ä¿å­˜åˆ°è®°äº‹æœ¬</button>
                    </div>
                    
                    <div class="export-result-mobile">
                        <label for="exportTextArea">å¯¼å‡ºç»“æœ</label>
                        <textarea id="exportTextArea" rows="10" readonly placeholder="ç‚¹å‡»æ˜¾ç¤ºç»“æœæˆ–å¯¼å‡ºæ•°æ®æŒ‰é’®åï¼Œå†…å®¹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..." style="height: 200px; resize: none;"></textarea>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- äº‹ä»¶è¯¦æƒ…å¼¹çª— -->
        <div id="eventModal" class="modal-mobile" style="display: none;">
            <div class="modal-content-mobile">
                <div class="modal-header-mobile">
                    <h3 id="modalTitle">äº‹ä»¶è¯¦æƒ…</h3>
                    <button class="close-mobile" onclick="closeEventModal()">Ã—</button>
                </div>
                <div class="modal-body-mobile" id="modalBody">
                    <!-- äº‹ä»¶è¯¦æƒ…å†…å®¹ -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // ç…§ç‰‡ä¸Šä¼ åŠŸèƒ½ä¿®å¤è„šæœ¬
        console.log('ğŸ”§ åŠ è½½ç…§ç‰‡ä¸Šä¼ ä¿®å¤è„šæœ¬');
        
        // ç¡®ä¿ç…§ç‰‡ä¸Šä¼ å˜é‡å­˜åœ¨
        if (typeof uploadedPhotos === 'undefined') {
            window.uploadedPhotos = {
                photo1: null,
                photo2: null
            };
        }
        
        if (typeof requiredPhotoCount === 'undefined') {
            window.requiredPhotoCount = 0;
        }
        
        // é‡æ–°å®šä¹‰å…³é”®å‡½æ•°ï¼Œç¡®ä¿å®ƒä»¬èƒ½æ­£å¸¸å·¥ä½œ
        window.handleOvertimeTimeSlotChange = function() {
            console.log('ğŸ”„ æ—¶é—´æ®µå˜åŒ–äº‹ä»¶è§¦å‘ï¼ˆä¿®å¤ç‰ˆï¼‰');
            
            const timeSlot = document.getElementById('overtimeTimeSlot').value;
            const customDiv = document.getElementById('customOvertimeTimeSlot');
            const photoSection = document.getElementById('photoUploadSection');
            const timeSlotInfo = document.getElementById('timeSlotInfo');
            const requiredPhotos = document.getElementById('requiredPhotos');
            const photoUpload2 = document.getElementById('photoUpload2');
            
            console.log('ğŸ“‹ é€‰æ‹©çš„æ—¶é—´æ®µ:', timeSlot);
            console.log('ğŸ“‹ ç…§ç‰‡ä¸Šä¼ åŒºåŸŸå…ƒç´ :', photoSection ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
            
            // å¤„ç†è‡ªå®šä¹‰æ—¶é—´æ®µæ˜¾ç¤º
            if (customDiv) {
                customDiv.style.display = timeSlot === 'custom' ? 'block' : 'none';
            }
            
            // å¤„ç†ç…§ç‰‡ä¸Šä¼ åŒºåŸŸ
            if (timeSlot && timeSlot !== '') {
                if (photoSection) {
                    photoSection.style.display = 'block';
                    console.log('âœ… æ˜¾ç¤ºç…§ç‰‡ä¸Šä¼ åŒºåŸŸ');
                }
                if (timeSlotInfo) {
                    timeSlotInfo.style.display = 'block';
                }
                
                // æ ¹æ®æ—¶é—´æ®µè®¾ç½®ç…§ç‰‡è¦æ±‚
                if (timeSlot === 'morning') {
                    window.requiredPhotoCount = 1;
                    if (requiredPhotos) requiredPhotos.textContent = '(éœ€è¦1å¼ ç…§ç‰‡)';
                    if (photoUpload2) photoUpload2.style.display = 'none';
                    if (timeSlotInfo && timeSlotInfo.querySelector('.info-text')) {
                        timeSlotInfo.querySelector('.info-text').textContent = 'ä¸Šåˆæ—¶é—´æ®µéœ€è¦ä¸Šä¼ 1å¼ å·¥ä½œç…§ç‰‡';
                    }
                    console.log('ğŸ“· è®¾ç½®ä¸Šåˆç…§ç‰‡è¦æ±‚: 1å¼ ');
                } else if (timeSlot === 'afternoon') {
                    window.requiredPhotoCount = 2;
                    if (requiredPhotos) requiredPhotos.textContent = '(éœ€è¦2å¼ ç…§ç‰‡)';
                    if (photoUpload2) photoUpload2.style.display = 'block';
                    if (timeSlotInfo && timeSlotInfo.querySelector('.info-text')) {
                        timeSlotInfo.querySelector('.info-text').textContent = 'ä¸‹åˆæ—¶é—´æ®µéœ€è¦ä¸Šä¼ 2å¼ å·¥ä½œç…§ç‰‡';
                    }
                    console.log('ğŸ“· è®¾ç½®ä¸‹åˆç…§ç‰‡è¦æ±‚: 2å¼ ');
                } else if (timeSlot === 'evening') {
                    window.requiredPhotoCount = 2;
                    if (requiredPhotos) requiredPhotos.textContent = '(éœ€è¦2å¼ ç…§ç‰‡)';
                    if (photoUpload2) photoUpload2.style.display = 'block';
                    if (timeSlotInfo && timeSlotInfo.querySelector('.info-text')) {
                        timeSlotInfo.querySelector('.info-text').textContent = 'æ™šä¸Šæ—¶é—´æ®µéœ€è¦ä¸Šä¼ 2å¼ å·¥ä½œç…§ç‰‡';
                    }
                    console.log('ğŸ“· è®¾ç½®æ™šä¸Šç…§ç‰‡è¦æ±‚: 2å¼ ');
                } else if (timeSlot === 'custom') {
                    window.requiredPhotoCount = 2;
                    if (requiredPhotos) requiredPhotos.textContent = '(éœ€è¦2å¼ ç…§ç‰‡)';
                    if (photoUpload2) photoUpload2.style.display = 'block';
                    if (timeSlotInfo && timeSlotInfo.querySelector('.info-text')) {
                        timeSlotInfo.querySelector('.info-text').textContent = 'è‡ªå®šä¹‰æ—¶é—´æ®µéœ€è¦ä¸Šä¼ 2å¼ å·¥ä½œç…§ç‰‡';
                    }
                    console.log('ğŸ“· è®¾ç½®è‡ªå®šä¹‰ç…§ç‰‡è¦æ±‚: 2å¼ ');
                }
                
                // é‡ç½®ç…§ç‰‡ä¸Šä¼ çŠ¶æ€
                if (typeof resetPhotoUploads === 'function') {
                    resetPhotoUploads();
                } else {
                    // æ‰‹åŠ¨é‡ç½®
                    window.uploadedPhotos.photo1 = null;
                    window.uploadedPhotos.photo2 = null;
                    
                    for (let i = 1; i <= 2; i++) {
                        const preview = document.getElementById(`photoPreview${i}`);
                        const placeholder = document.getElementById(`photoUpload${i}`);
                        const fileInput = document.getElementById(`photoFile${i}`);
                        
                        if (preview) preview.style.display = 'none';
                        if (placeholder && placeholder.querySelector('.upload-placeholder')) {
                            placeholder.querySelector('.upload-placeholder').style.display = 'flex';
                        }
                        if (fileInput) fileInput.value = '';
                    }
                }
                
                // æ˜¾ç¤ºéªŒè¯åŒºåŸŸ
                const formValidation = document.getElementById('formValidation');
                if (formValidation) {
                    formValidation.style.display = 'block';
                }
            } else {
                if (photoSection) {
                    photoSection.style.display = 'none';
                    console.log('âŒ éšè—ç…§ç‰‡ä¸Šä¼ åŒºåŸŸ');
                }
                if (timeSlotInfo) {
                    timeSlotInfo.style.display = 'none';
                }
                const formValidation = document.getElementById('formValidation');
                if (formValidation) {
                    formValidation.style.display = 'none';
                }
                window.requiredPhotoCount = 0;
            }
        };
        
        // é‡æ–°å®šä¹‰ç…§ç‰‡ä¸Šä¼ è§¦å‘å‡½æ•°
        window.triggerPhotoUpload = function(photoNumber) {
            console.log(`ğŸ“· è§¦å‘ç…§ç‰‡ä¸Šä¼ : ${photoNumber}`);
            const fileInput = document.getElementById(`photoFile${photoNumber}`);
            if (fileInput) {
                fileInput.click();
                console.log(`âœ… æˆåŠŸè§¦å‘ç…§ç‰‡${photoNumber}é€‰æ‹©`);
            } else {
                console.error(`âŒ æ‰¾ä¸åˆ°photoFile${photoNumber}å…ƒç´ `);
            }
        };
        
        // é‡æ–°å®šä¹‰ç…§ç‰‡ä¸Šä¼ å¤„ç†å‡½æ•°
        window.handlePhotoUpload = function(event, photoNumber) {
            const file = event.target.files[0];
            if (!file) return;
            
            console.log(`å¤„ç†ç…§ç‰‡ä¸Šä¼ : ${photoNumber}, æ–‡ä»¶:`, file.name);
            
            // éªŒè¯æ–‡ä»¶ç±»å‹
            if (!file.type.startsWith('image/')) {
                alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
                return;
            }
            
            // éªŒè¯æ–‡ä»¶å¤§å°ï¼ˆé™åˆ¶ä¸º5MBï¼‰
            if (file.size > 5 * 1024 * 1024) {
                alert('å›¾ç‰‡æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                // ä¿å­˜ç…§ç‰‡æ•°æ®
                window.uploadedPhotos[`photo${photoNumber}`] = {
                    file: file,
                    dataUrl: e.target.result,
                    name: file.name,
                    size: file.size
                };
                
                // æ˜¾ç¤ºé¢„è§ˆ
                const preview = document.getElementById(`photoPreview${photoNumber}`);
                const placeholder = document.getElementById(`photoUpload${photoNumber}`).querySelector('.upload-placeholder');
                const img = document.getElementById(`photoImg${photoNumber}`);
                
                if (img && preview && placeholder) {
                    img.src = e.target.result;
                    placeholder.style.display = 'none';
                    preview.style.display = 'block';
                    
                    console.log(`ç…§ç‰‡${photoNumber}ä¸Šä¼ æˆåŠŸ:`, file.name);
                }
            };
            
            reader.readAsDataURL(file);
        };
        
        // é‡æ–°å®šä¹‰ç§»é™¤ç…§ç‰‡å‡½æ•°
        window.removePhoto = function(photoNumber) {
            window.uploadedPhotos[`photo${photoNumber}`] = null;
            
            const preview = document.getElementById(`photoPreview${photoNumber}`);
            const placeholder = document.getElementById(`photoUpload${photoNumber}`).querySelector('.upload-placeholder');
            const fileInput = document.getElementById(`photoFile${photoNumber}`);
            
            if (preview && placeholder && fileInput) {
                preview.style.display = 'none';
                placeholder.style.display = 'flex';
                fileInput.value = '';
                
                console.log(`ç…§ç‰‡${photoNumber}å·²ç§»é™¤`);
            }
        };
    </script>
    <script>
        // æ ‡ç­¾é¡µåŠŸèƒ½ä¿®å¤
        console.log('ğŸ”§ åŠ è½½æ ‡ç­¾é¡µä¿®å¤è„šæœ¬');
        
        // ç¡®ä¿showTabå‡½æ•°å¯ç”¨
        window.showTab = function(tabName, buttonElement) {
            console.log('åˆ‡æ¢æ ‡ç­¾é¡µ:', tabName);
            
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µ
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æŒ‰é’®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // æ˜¾ç¤ºç›®æ ‡æ ‡ç­¾é¡µ
            const targetTab = document.getElementById(tabName);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            // æ¿€æ´»æŒ‰é’®
            if (buttonElement) {
                buttonElement.classList.add('active');
            }
            
            // æ‰§è¡Œç‰¹å®šé€»è¾‘
            setTimeout(() => {
                try {
                    if (tabName === 'history') {
                        if (typeof updateStatistics === 'function') updateStatistics();
                        if (typeof updateHistoryView === 'function') updateHistoryView();
                        if (typeof checkExpirationWarnings === 'function') checkExpirationWarnings();
                        if (typeof renderCalendar === 'function') renderCalendar();
                    }
                    if (tabName === 'compensatory') {
                        if (typeof updateRelatedOvertimeOptions === 'function') updateRelatedOvertimeOptions();
                        if (typeof updateTimeSlotByShift === 'function') updateTimeSlotByShift();
                    }
                    if (tabName === 'export') {
                        if (typeof updateExportYearOptions === 'function') updateExportYearOptions();
                    }
                } catch (e) {
                    console.warn('æ‰§è¡Œæ ‡ç­¾é¡µé€»è¾‘æ—¶å‡ºé”™:', e);
                }
            }, 100);
        };
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMåŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–æ ‡ç­¾é¡µ');
            
            // ç¡®ä¿ç¬¬ä¸€ä¸ªæ ‡ç­¾é¡µæ˜¯æ´»åŠ¨çš„
            const firstTab = document.getElementById('overtime');
            const firstButton = document.querySelector('.tab-button');
            
            if (firstTab) firstTab.classList.add('active');
            if (firstButton) firstButton.classList.add('active');
            
            // é‡æ–°ç»‘å®šç…§ç‰‡ä¸Šä¼ ç›¸å…³äº‹ä»¶
            console.log('ğŸ”§ é‡æ–°ç»‘å®šç…§ç‰‡ä¸Šä¼ äº‹ä»¶');
            
            // é‡æ–°ç»‘å®šæ—¶é—´æ®µé€‰æ‹©äº‹ä»¶
            const timeSlotSelect = document.getElementById('overtimeTimeSlot');
            if (timeSlotSelect) {
                // ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œæ·»åŠ æ–°çš„
                timeSlotSelect.removeEventListener('change', handleOvertimeTimeSlotChange);
                timeSlotSelect.addEventListener('change', window.handleOvertimeTimeSlotChange);
                console.log('âœ… æ—¶é—´æ®µé€‰æ‹©äº‹ä»¶ç»‘å®šæˆåŠŸ');
            }
            
            // é‡æ–°ç»‘å®šç…§ç‰‡ä¸Šä¼ äº‹ä»¶
            const photoFile1 = document.getElementById('photoFile1');
            const photoFile2 = document.getElementById('photoFile2');
            
            if (photoFile1) {
                photoFile1.addEventListener('change', (e) => window.handlePhotoUpload(e, 1));
                console.log('âœ… ç…§ç‰‡1ä¸Šä¼ äº‹ä»¶ç»‘å®šæˆåŠŸ');
            }
            
            if (photoFile2) {
                photoFile2.addEventListener('change', (e) => window.handlePhotoUpload(e, 2));
                console.log('âœ… ç…§ç‰‡2ä¸Šä¼ äº‹ä»¶ç»‘å®šæˆåŠŸ');
            }
            
            console.log('ğŸ‰ ç…§ç‰‡ä¸Šä¼ åŠŸèƒ½ä¿®å¤å®Œæˆï¼');
            console.log('æ ‡ç­¾é¡µåˆå§‹åŒ–å®Œæˆ');
        });
    </script>
</body>
</html>